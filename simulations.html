<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.296">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Ctsem Simulations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="simulations_files/libs/clipboard/clipboard.min.js"></script>
<script src="simulations_files/libs/quarto-html/quarto.js"></script>
<script src="simulations_files/libs/quarto-html/popper.min.js"></script>
<script src="simulations_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="simulations_files/libs/quarto-html/anchor.min.js"></script>
<link href="simulations_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="simulations_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="simulations_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="simulations_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="simulations_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Ctsem Simulations</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ctsem)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expm)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16917042</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="model-with-2-latent-processes" class="level2">
<h2 class="anchored" data-anchor-id="model-with-2-latent-processes">Model with 2 latent processes</h2>
<section id="simulated-data" class="level3">
<h3 class="anchored" data-anchor-id="simulated-data">Simulated data</h3>
<ul>
<li>200 time points</li>
<li>N = 1</li>
<li>2 latent processes</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute drift matrix from discrete time effects with a time interval of 1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>delta_t <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>drift_matrix_1 <span class="ot">&lt;-</span> expm<span class="sc">::</span><span class="fu">logm</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.7</span>), <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">/</span> delta_t</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>rel <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># model to simulate data</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>generating_model_1 <span class="ot">&lt;-</span> <span class="fu">ctModel</span>(<span class="at">Tpoints =</span> <span class="dv">200</span>, <span class="at">n.latent =</span> <span class="dv">2</span>, <span class="at">n.TDpred =</span> <span class="dv">0</span>, <span class="at">n.TIpred =</span> <span class="dv">0</span>, <span class="at">n.manifest =</span> <span class="dv">2</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">LAMBDA =</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">MANIFESTVAR =</span> <span class="fu">diag</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">MANIFESTMEANS =</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">DRIFT =</span> drift_matrix_1,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                              <span class="co">#TRAITVAR = matrix(c(0.5, 0.2, 0, 0.8), nrow=2), # erst bei n &gt; 1</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">DIFFUSION =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">T0MEANS =</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">T0VAR =</span> <span class="fu">diag</span>(<span class="fl">0.1</span>, <span class="dv">2</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> <span class="fu">ctGenerate</span>(generating_model_1, <span class="at">n.subjects =</span> <span class="dv">1</span>, <span class="at">burnin =</span> <span class="dv">100</span>, <span class="at">dtmean =</span> <span class="fl">0.15</span>, <span class="at">logdtsd =</span> .<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-specification" class="level3">
<h3 class="anchored" data-anchor-id="model-specification">Model specification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> <span class="fu">ctModel</span>(<span class="at">type =</span> <span class="st">"stanct"</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n.latent =</span> <span class="dv">2</span>, <span class="at">latentNames=</span><span class="fu">c</span>(<span class="st">'symptom_severity'</span>,<span class="st">'avoidance'</span>),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n.manifest =</span> <span class="dv">2</span>, <span class="at">manifestNames=</span><span class="fu">c</span>(<span class="st">'Y1'</span>,<span class="st">'Y2'</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">LAMBDA=</span><span class="fu">diag</span>(<span class="dv">2</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>model_1<span class="sc">$</span>pars<span class="sc">$</span>indvarying <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#ctModelLatex(model_1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(model_1<span class="sc">$</span>pars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   matrix row col                param value  transform indvarying sdscale
1 T0MEANS   1   1 T0m_symptom_severity    NA 10 * param      FALSE       1
2 T0MEANS   2   1        T0m_avoidance    NA 10 * param      FALSE       1
3  LAMBDA   1   1                 &lt;NA&gt;     1       &lt;NA&gt;      FALSE      NA
4  LAMBDA   1   2                 &lt;NA&gt;     0       &lt;NA&gt;      FALSE      NA
5  LAMBDA   2   1                 &lt;NA&gt;     0       &lt;NA&gt;      FALSE      NA
6  LAMBDA   2   2                 &lt;NA&gt;     1       &lt;NA&gt;      FALSE      NA</code></pre>
</div>
</div>
</section>
<section id="model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="model-fitting">Model fitting</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">ctStanFit</span>(<span class="at">datalong =</span> data_1, <span class="at">ctstanmodel =</span> model_1, <span class="at">priors =</span> <span class="cn">FALSE</span>, <span class="at">optimize =</span> <span class="cn">TRUE</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># priors: True -&gt; HMC, false -&gt; max likelihood</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-and-plots" class="level3">
<h3 class="anchored" data-anchor-id="summary-and-plots">Summary and plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$residCovStd
      Y1    Y2
Y1 0.034 0.020
Y2 0.020 0.044

$resiCovStdNote
[1] "Standardised covariance of residuals"

$priorcheck_note
[1] "The following posteriors exceeded arbitrary limits re normal(0,1) -- priors / transforms are likely somewhat informative. Not necessarily a problem."

$priorcheck
                                          mean   sd
rawpop_drift_symptom_severity             1.20 0.67
rawpop_drift_symptom_severity_avoidance   0.09 0.28
rawpop_mvarY1                           -19.24 3.45
rawpop_mvarY2                           -19.23 4.61

$parmatrices
             matrix row col    Mean      sd    2.5%     50%   97.5%
1           T0MEANS   1   1 -0.0403  1.3560 -2.7638 -0.0116  2.5096
2           T0MEANS   2   1  0.3291  1.2164 -1.9517  0.3237  2.7063
3            LAMBDA   1   1  1.0000  0.0000  1.0000  1.0000  1.0000
4            LAMBDA   1   2  0.0000  0.0000  0.0000  0.0000  0.0000
5            LAMBDA   2   1  0.0000  0.0000  0.0000  0.0000  0.0000
6            LAMBDA   2   2  1.0000  0.0000  1.0000  1.0000  1.0000
7             DRIFT   1   1 -0.3398  0.4627 -1.7434 -0.1616 -0.0149
8             DRIFT   1   2  0.0869  0.2812 -0.4301  0.0839  0.6371
9             DRIFT   2   1  0.5284  0.1942  0.1312  0.5319  0.9216
10            DRIFT   2   2 -0.8065  0.2553 -1.3906 -0.7741 -0.4002
15    MANIFESTMEANS   1   1 -1.0530  0.8764 -2.8045 -1.0855  0.6793
16    MANIFESTMEANS   2   1 -1.1051  0.6683 -2.4259 -1.1247  0.1653
17             CINT   1   1  0.0000  0.0000  0.0000  0.0000  0.0000
18             CINT   2   1  0.0000  0.0000  0.0000  0.0000  0.0000
23         asymCINT   1   1  0.0000  0.0000  0.0000  0.0000  0.0000
24         asymCINT   2   1  0.0000  0.0000  0.0000  0.0000  0.0000
25 asymDIFFUSIONcov   1   1 -0.2701 35.7901 -2.8179  0.6481  4.7828
26 asymDIFFUSIONcov   1   2 -0.3692 30.9349 -2.1247  0.4372  3.9330
27 asymDIFFUSIONcov   2   1 -0.3692 30.9349 -2.1247  0.4372  3.9330
28 asymDIFFUSIONcov   2   2 -0.2870 26.7508 -1.5258  0.4197  3.2504
29     DIFFUSIONcov   1   1  0.2475  0.0253  0.2024  0.2466  0.2991
30     DIFFUSIONcov   1   2  0.1038  0.0182  0.0681  0.1032  0.1419
31     DIFFUSIONcov   2   1  0.1038  0.0182  0.0681  0.1032  0.1419
32     DIFFUSIONcov   2   2  0.2095  0.0216  0.1691  0.2083  0.2562
33      MANIFESTcov   1   1  0.0000  0.0000  0.0000  0.0000  0.0000
34      MANIFESTcov   1   2  0.0000  0.0000  0.0000  0.0000  0.0000
35      MANIFESTcov   2   1  0.0000  0.0000  0.0000  0.0000  0.0000
36      MANIFESTcov   2   2  0.0000  0.0000  0.0000  0.0000  0.0000
37            T0cov   1   1  1.0000  0.0000  1.0000  1.0000  1.0000
38            T0cov   1   2  0.0000  0.0000  0.0000  0.0000  0.0000
39            T0cov   2   1  0.0000  0.0000  0.0000  0.0000  0.0000
40            T0cov   2   2  1.0000  0.0000  1.0000  1.0000  1.0000
41          dtDRIFT   1   1  0.7680  0.1983  0.2086  0.8573  0.9486
42          dtDRIFT   1   2  0.0380  0.1482 -0.2656  0.0537  0.2841
43          dtDRIFT   2   1  0.3088  0.1094  0.0613  0.3244  0.4789
44          dtDRIFT   2   2  0.4658  0.1265  0.2111  0.4739  0.6877

$popmeans
                                    mean     sd    2.5%     50%   97.5%
T0m_symptom_severity             -0.0403 1.3560 -2.7638 -0.0116  2.5096
T0m_avoidance                     0.3291 1.2164 -1.9517  0.3237  2.7063
drift_symptom_severity           -0.3398 0.4627 -1.7434 -0.1616 -0.0149
drift_symptom_severity_avoidance  0.0869 0.2812 -0.4301  0.0839  0.6371
drift_avoidance_symptom_severity  0.5284 0.1942  0.1312  0.5319  0.9216
drift_avoidance                  -0.8065 0.2553 -1.3906 -0.7741 -0.4002
diff_symptom_severity             0.4969 0.0253  0.4499  0.4965  0.5469
diff_avoidance_symptom_severity   0.2476 0.0360  0.1750  0.2473  0.3147
diff_avoidance                    0.4571 0.0235  0.4112  0.4564  0.5061
mvarY1                            0.0000 0.0000  0.0000  0.0000  0.0000
mvarY2                            0.0000 0.0000  0.0000  0.0000  0.0000
mm_Y1                            -1.0530 0.8764 -2.8045 -1.0855  0.6793
mm_Y2                            -1.1051 0.6683 -2.4259 -1.1247  0.1653

$popNote
[1] "popmeans are reported as specified in ctModel -- covariance related matrices are in sd / unconstrained correlation form -- see $parmatrices for simpler interpretations!"

$loglik
[1] 141.0931

$npars
[1] 13

$aic
[1] -256.1862

$logposterior
[1] 141.0931</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_1)<span class="sc">$</span>popmeans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                    mean     sd    2.5%     50%   97.5%
T0m_symptom_severity             -0.0403 1.3560 -2.7638 -0.0116  2.5096
T0m_avoidance                     0.3291 1.2164 -1.9517  0.3237  2.7063
drift_symptom_severity           -0.3398 0.4627 -1.7434 -0.1616 -0.0149
drift_symptom_severity_avoidance  0.0869 0.2812 -0.4301  0.0839  0.6371
drift_avoidance_symptom_severity  0.5284 0.1942  0.1312  0.5319  0.9216
drift_avoidance                  -0.8065 0.2553 -1.3906 -0.7741 -0.4002
diff_symptom_severity             0.4969 0.0253  0.4499  0.4965  0.5469
diff_avoidance_symptom_severity   0.2476 0.0360  0.1750  0.2473  0.3147
diff_avoidance                    0.4571 0.0235  0.4112  0.4564  0.5061
mvarY1                            0.0000 0.0000  0.0000  0.0000  0.0000
mvarY2                            0.0000 0.0000  0.0000  0.0000  0.0000
mm_Y1                            -1.0530 0.8764 -2.8045 -1.0855  0.6793
mm_Y2                            -1.1051 0.6683 -2.4259 -1.1247  0.1653</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ctStanContinuousPars</span>(fit_1, <span class="at">calcfunc =</span> quantile,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="fl">0.5</span>))<span class="sc">$</span>DRIFT[<span class="dv">1</span>,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1616406</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simulations_files/figure-html/unnamed-chunk-8-1.png" class="quarto-discovered-preview-image img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Input [s] to stop, or leave blank and press [return] for next plot.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="simulations_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Input [s] to stop, or leave blank and press [return] for next plot.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ctStanDiscretePars</span>(fit_1, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="co"># regression coefficient for particular time intervals</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">indices =</span> <span class="st">'CR'</span>) <span class="co"># cross effects (AR would be auto effects)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simulations_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ctStanPlotPost(obj = fit, rows = 3) # posterior vs prior</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ctKalman</span>(fit_1, <span class="at">subjects =</span> <span class="dv">1</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">timerange =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">timestep =</span> <span class="dv">3</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">kalmanvec =</span> <span class="fu">c</span>(<span class="st">'y'</span>, <span class="st">'etaprior'</span>), </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">plotcontrol =</span> <span class="fu">list</span>(<span class="at">xaxs =</span> <span class="st">'i'</span>, <span class="at">main =</span> <span class="st">"Predicted"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simulations_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generating model</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>delta_t <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>drift_matrix_true <span class="ot">&lt;-</span> <span class="fu">logm</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.7</span>), <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">/</span> delta_t</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>generating_model_200 <span class="ot">&lt;-</span> <span class="fu">ctModel</span>(<span class="at">Tpoints =</span> <span class="dv">200</span>, <span class="at">n.latent =</span> <span class="dv">2</span>, <span class="at">n.TDpred =</span> <span class="dv">0</span>, <span class="at">n.TIpred =</span> <span class="dv">0</span>, <span class="at">n.manifest =</span> <span class="dv">2</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">LAMBDA =</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">MANIFESTVAR =</span> <span class="fu">diag</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">MANIFESTMEANS =</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">DRIFT =</span> drift_matrix_true,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                                <span class="co">#TRAITVAR = matrix(c(0.5, 0.2, 0, 0.8), nrow=2), # erst bei n &gt; 1</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">DIFFUSION =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">T0MEANS =</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">T0VAR =</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>generating_model_5000 <span class="ot">&lt;-</span> <span class="fu">ctModel</span>(<span class="at">Tpoints =</span> <span class="dv">5000</span>, <span class="at">n.latent =</span> <span class="dv">2</span>, <span class="at">n.TDpred =</span> <span class="dv">0</span>, <span class="at">n.TIpred =</span> <span class="dv">0</span>, <span class="at">n.manifest =</span> <span class="dv">2</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">LAMBDA =</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">MANIFESTVAR =</span> <span class="fu">diag</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">MANIFESTMEANS =</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>                                <span class="at">DRIFT =</span> drift_matrix_true,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>                                <span class="co">#TRAITVAR = matrix(c(0.5, 0.2, 0, 0.8), nrow=2), # erst bei n &gt; 1</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>                                <span class="at">DIFFUSION =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>                                <span class="at">T0MEANS =</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                                <span class="at">T0VAR =</span> <span class="fu">diag</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sim_ctsem <span class="ot">&lt;-</span> <span class="cf">function</span>(n_sims, n_subjects, generating_model, <span class="at">alpha =</span> <span class="fl">0.05</span>){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize results data frame</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  drift_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">iter =</span> <span class="fu">integer</span>(),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_symptom_severity =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_symptom_severity_lower =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_symptom_severity_upper =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_symptom_severity_significance =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_symptom_severity_avoidance =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_symptom_severity_avoidance_lower =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_symptom_severity_avoidance_upper =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_symptom_severity_avoidance_significance =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_avoidance_symptom_severity =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_avoidance_symptom_severity_lower =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_avoidance_symptom_severity_upper =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_avoidance_symptom_severity_significance =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_avoidance =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_avoidance_lower =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_avoidance_upper =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">drift_avoidance_significance =</span> <span class="fu">numeric</span>()</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop </span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sims) {</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Generate data</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>      data_sim <span class="ot">&lt;-</span> <span class="fu">ctGenerate</span>(generating_model, <span class="at">n.subjects =</span> n_subjects, <span class="at">burnin =</span> <span class="dv">100</span>, <span class="at">dtmean =</span> <span class="fl">0.15</span>, <span class="at">logdtsd =</span> .<span class="dv">1</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Model specification</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>      model_sim <span class="ot">&lt;-</span> <span class="fu">ctModel</span>(<span class="at">type =</span> <span class="st">"stanct"</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>                           <span class="at">n.latent =</span> <span class="dv">2</span>, <span class="at">latentNames=</span><span class="fu">c</span>(<span class="st">'symptom_severity'</span>,<span class="st">'avoidance'</span>),</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">n.manifest =</span> <span class="dv">2</span>, <span class="at">manifestNames=</span><span class="fu">c</span>(<span class="st">'Y1'</span>,<span class="st">'Y2'</span>),</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>                           <span class="at">LAMBDA=</span><span class="fu">diag</span>(<span class="dv">2</span>))</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>      model_sim<span class="sc">$</span>pars<span class="sc">$</span>indvarying <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Model fitting</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>      fit_sim <span class="ot">&lt;-</span> <span class="fu">ctStanFit</span>(<span class="at">datalong =</span> data_sim, <span class="at">ctstanmodel =</span> model_sim, <span class="at">priors =</span> <span class="cn">FALSE</span>, <span class="at">optimize =</span> <span class="cn">TRUE</span>) </span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Drift matrix estimates</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>      drift_matrix <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_sim)<span class="sc">$</span>parmatrices<span class="sc">$</span>DRIFT</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>      drift_results[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(i,</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">summary</span>(fit_sim)<span class="sc">$</span>popmeans[<span class="dv">3</span>, <span class="dv">1</span>], <span class="co"># Auto-effect of symptom severity</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">$</span>DRIFT[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">$</span>DRIFT[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">!</span>(<span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="fl">0.025</span>))<span class="sc">$</span>DRIFT[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="fl">0.975</span>))<span class="sc">$</span>DRIFT[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">&gt;=</span> <span class="dv">0</span>),</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">summary</span>(fit_sim)<span class="sc">$</span>popmeans[<span class="dv">4</span>, <span class="dv">1</span>], <span class="co"># Cross-effect from symptom severity to avoidance</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">$</span>DRIFT[<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">$</span>DRIFT[<span class="dv">1</span>,<span class="dv">2</span>],</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">!</span>(<span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="fl">0.025</span>))<span class="sc">$</span>DRIFT[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="fl">0.975</span>))<span class="sc">$</span>DRIFT[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="dv">0</span>),</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">summary</span>(fit_sim)<span class="sc">$</span>popmeans[<span class="dv">5</span>, <span class="dv">1</span>], <span class="co"># Cross-effect from avoidance to symptom severity</span></span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">$</span>DRIFT[<span class="dv">2</span>,<span class="dv">1</span>],</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">$</span>DRIFT[<span class="dv">2</span>,<span class="dv">1</span>],</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">!</span>(<span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="fl">0.025</span>))<span class="sc">$</span>DRIFT[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="fl">0.975</span>))<span class="sc">$</span>DRIFT[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">&gt;=</span> <span class="dv">0</span>),</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">summary</span>(fit_sim)<span class="sc">$</span>popmeans[<span class="dv">6</span>, <span class="dv">1</span>],  <span class="co"># Auto-effect of avoidance</span></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">$</span>DRIFT[<span class="dv">2</span>,<span class="dv">2</span>],</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>))<span class="sc">$</span>DRIFT[<span class="dv">2</span>,<span class="dv">2</span>],</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">!</span>(<span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="fl">0.025</span>))<span class="sc">$</span>DRIFT[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">ctStanContinuousPars</span>(fit_sim, <span class="at">calcfunc =</span> quantile, </span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">calcfuncargs =</span> <span class="fu">list</span>(<span class="at">probs =</span> <span class="fl">0.975</span>))<span class="sc">$</span>DRIFT[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">&gt;=</span> <span class="dv">0</span>)</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Progress indicator</span></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">50</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Completed simulation"</span>, i, <span class="st">"of"</span>, n_sims, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Handle convergence failures</span></span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Simulation"</span>, i, <span class="st">"failed:"</span>, e<span class="sc">$</span>message, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>      drift_results[i, <span class="dv">2</span><span class="sc">:</span><span class="dv">17</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(drift_results)</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="results-and-plots" class="level3">
<h3 class="anchored" data-anchor-id="results-and-plots">Results and plots</h3>
<div class="cell" data-hash="simulations_cache/html/unnamed-chunk-12_d2df808bbfd4849d040acfed3dd662ef">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">sim_ctsem</span>(<span class="dv">500</span>, <span class="dv">1</span>, generating_model_200)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 50 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 100 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in delta[abs(delta) &gt; maxparchange] &lt;- maxparchange * sign(delta[abs(delta) &gt;  : 
  NAs are not allowed in subscripted assignments</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in delta[abs(delta) &gt; maxparchange] &lt;- maxparchange * sign(delta[abs(delta) &gt;  : 
  NAs are not allowed in subscripted assignments</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in delta[abs(delta) &gt; maxparchange] &lt;- maxparchange * sign(delta[abs(delta) &gt;  : 
  NAs are not allowed in subscripted assignments</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 150 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 200 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in delta[abs(delta) &gt; maxparchange] &lt;- maxparchange * sign(delta[abs(delta) &gt;  : 
  NAs are not allowed in subscripted assignments</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 250 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 300 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 350 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 400 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 450 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Possible time step problem? Intervals too large? Try reduce maxtimestep
Possible time step problem? Intervals too large? Try reduce maxtimestep
Possible time step problem? Intervals too large? Try reduce maxtimestep
Possible time step problem? Intervals too large? Try reduce maxtimestep
Error in eval(expr, envir) : 
  Exception: quad_form_sym: A is not symmetric. A[1,2] = nan, but A[2,1] = nan  (in 'model_ctsm' at line 895)

Possible time step problem? Intervals too large? Try reduce maxtimestep
Possible time step problem? Intervals too large? Try reduce maxtimestep
Possible time step problem? Intervals too large? Try reduce maxtimestep
Possible time step problem? Intervals too large? Try reduce maxtimestep
Error in eval(expr, envir) : 
  Exception: quad_form_sym: A is not symmetric. A[1,2] = nan, but A[2,1] = nan  (in 'model_ctsm' at line 895)

Possible time step problem? Intervals too large? Try reduce maxtimestep
Possible time step problem? Intervals too large? Try reduce maxtimestep</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 500 of 500 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>results_t_5000 <span class="ot">&lt;-</span> <span class="fu">sim_ctsem</span>(<span class="dv">500</span>, <span class="dv">1</span>, generating_model_5000)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 50 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 100 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 150 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 200 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 250 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in delta[abs(delta) &gt; maxparchange] &lt;- maxparchange * sign(delta[abs(delta) &gt;  : 
  NAs are not allowed in subscripted assignments</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in delta[abs(delta) &gt; maxparchange] &lt;- maxparchange * sign(delta[abs(delta) &gt;  : 
  NAs are not allowed in subscripted assignments</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 300 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 350 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in sgd(init, fitfunc = target, parsets = parsets, nsubsets = 1,  : 
  NA in parameter proposal!</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 400 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 450 of 500 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed simulation 500 of 500 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results[, <span class="dv">2</span><span class="sc">:</span><span class="dv">17</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> drift_symptom_severity drift_symptom_severity_lower
 Min.   :-1205.7706     Min.   :-6059.426           
 1st Qu.:   -0.6981     1st Qu.:   -1.583           
 Median :   -0.5320     Median :   -1.252           
 Mean   :   -9.6401     Mean   :  -49.275           
 3rd Qu.:   -0.3899     3rd Qu.:   -1.067           
 Max.   :    0.0000     Max.   :    0.000           
 drift_symptom_severity_upper drift_symptom_severity_significance
 Min.   :-0.894451            Min.   :1                          
 1st Qu.:-0.268286            1st Qu.:1                          
 Median :-0.145445            Median :1                          
 Mean   :-0.184296            Mean   :1                          
 3rd Qu.:-0.046275            3rd Qu.:1                          
 Max.   :-0.000001            Max.   :1                          
 drift_symptom_severity_avoidance drift_symptom_severity_avoidance_lower
 Min.   :-1.27620                 Min.   :-35.34112                     
 1st Qu.:-0.01533                 1st Qu.: -0.48518                     
 Median : 0.19725                 Median : -0.28415                     
 Mean   : 0.20476                 Mean   : -0.52045                     
 3rd Qu.: 0.41290                 3rd Qu.: -0.09655                     
 Max.   : 1.07910                 Max.   :  0.88861                     
 drift_symptom_severity_avoidance_upper
 Min.   :-0.7453                       
 1st Qu.: 0.4476                       
 Median : 0.6963                       
 Mean   : 0.9327                       
 3rd Qu.: 0.9429                       
 Max.   :33.5738                       
 drift_symptom_severity_avoidance_significance drift_avoidance_symptom_severity
 Min.   :0.000                                 Min.   :-0.6479                 
 1st Qu.:0.000                                 1st Qu.: 0.1050                 
 Median :0.000                                 Median : 0.2556                 
 Mean   :0.222                                 Mean   : 0.2705                 
 3rd Qu.:0.000                                 3rd Qu.: 0.4258                 
 Max.   :1.000                                 Max.   : 1.1854                 
 drift_avoidance_symptom_severity_lower drift_avoidance_symptom_severity_upper
 Min.   :-32.08589                      Min.   :-0.2309                       
 1st Qu.: -0.29029                      1st Qu.: 0.4703                       
 Median : -0.11897                      Median : 0.6414                       
 Mean   : -0.35825                      Mean   : 0.9066                       
 3rd Qu.:  0.04484                      3rd Qu.: 0.8298                       
 Max.   :  0.87068                      Max.   :34.5953                       
 drift_avoidance_symptom_severity_significance drift_avoidance     
 Min.   :0.000                                 Min.   :-183240.01  
 1st Qu.:0.000                                 1st Qu.:     -0.79  
 Median :0.000                                 Median :     -0.58  
 Mean   :0.332                                 Mean   :   -369.20  
 3rd Qu.:1.000                                 3rd Qu.:     -0.45  
 Max.   :1.000                                 Max.   :      0.00  
 drift_avoidance_lower drift_avoidance_upper drift_avoidance_significance
 Min.   :-857125.1     Min.   :-1.087172     Min.   :1                   
 1st Qu.:     -1.5     1st Qu.:-0.369894     1st Qu.:1                   
 Median :     -1.2     Median :-0.219612     Median :1                   
 Mean   :  -1726.7     Mean   :-0.263032     Mean   :1                   
 3rd Qu.:     -1.1     3rd Qu.:-0.113748     3rd Qu.:1                   
 Max.   :      0.0     Max.   :-0.000001     Max.   :1                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_t_5000[, <span class="dv">2</span><span class="sc">:</span><span class="dv">17</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> drift_symptom_severity drift_symptom_severity_lower
 Min.   :-9.9590        Min.   :-53.8207            
 1st Qu.:-0.2822        1st Qu.: -0.3661            
 Median :-0.2559        Median : -0.3352            
 Mean   :-0.2970        Mean   : -0.5738            
 3rd Qu.:-0.2279        3rd Qu.: -0.3028            
 Max.   :-0.1272        Max.   : -0.2070            
 drift_symptom_severity_upper drift_symptom_severity_significance
 Min.   :-0.326162            Min.   :1                          
 1st Qu.:-0.217250            1st Qu.:1                          
 Median :-0.189994            Median :1                          
 Mean   :-0.189516            Mean   :1                          
 3rd Qu.:-0.161494            3rd Qu.:1                          
 Max.   :-0.000001            Max.   :1                          
 drift_symptom_severity_avoidance drift_symptom_severity_avoidance_lower
 Min.   :0.0315                   Min.   :-13.95815                     
 1st Qu.:0.1700                   1st Qu.:  0.07949                     
 Median :0.2024                   Median :  0.11513                     
 Mean   :0.2015                   Mean   :  0.04927                     
 3rd Qu.:0.2323                   3rd Qu.:  0.14712                     
 Max.   :0.3938                   Max.   :  0.27529                     
 drift_symptom_severity_avoidance_upper
 Min.   : 0.1237                       
 1st Qu.: 0.2516                       
 Median : 0.2859                       
 Mean   : 0.3541                       
 3rd Qu.: 0.3215                       
 Max.   :14.2748                       
 drift_symptom_severity_avoidance_significance drift_avoidance_symptom_severity
 Min.   :0.000                                 Min.   :0.1679                  
 1st Qu.:1.000                                 1st Qu.:0.2431                  
 Median :1.000                                 Median :0.2676                  
 Mean   :0.968                                 Mean   :0.2682                  
 3rd Qu.:1.000                                 3rd Qu.:0.2921                  
 Max.   :1.000                                 Max.   :0.3770                  
 drift_avoidance_symptom_severity_lower drift_avoidance_symptom_severity_upper
 Min.   :-13.8183                       Min.   : 0.2235                       
 1st Qu.:  0.1758                       1st Qu.: 0.3078                       
 Median :  0.2013                       Median : 0.3347                       
 Mean   :  0.1332                       Mean   : 0.4029                       
 3rd Qu.:  0.2263                       3rd Qu.: 0.3643                       
 Max.   :  0.3085                       Max.   :14.3645                       
 drift_avoidance_symptom_severity_significance drift_avoidance  
 Min.   :0.000                                 Min.   :-9.9447  
 1st Qu.:1.000                                 1st Qu.:-0.4158  
 Median :1.000                                 Median :-0.3852  
 Mean   :0.984                                 Mean   :-0.4280  
 3rd Qu.:1.000                                 3rd Qu.:-0.3602  
 Max.   :1.000                                 Max.   :-0.2574  
 drift_avoidance_lower drift_avoidance_upper drift_avoidance_significance
 Min.   :-56.0730      Min.   :-0.451425     Min.   :1                   
 1st Qu.: -0.4999      1st Qu.:-0.349402     1st Qu.:1                   
 Median : -0.4685      Median :-0.314652     Median :1                   
 Mean   : -0.7054      Mean   :-0.314851     Mean   :1                   
 3rd Qu.: -0.4338      3rd Qu.:-0.289626     3rd Qu.:1                   
 Max.   : -0.3186      Max.   :-0.000001     Max.   :1                   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot drift_symptom_severity</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>delta_t <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>drift_matrix_true <span class="ot">&lt;-</span> <span class="fu">logm</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.7</span>), <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">/</span> delta_t</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co"># remove outliers</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>filtered_results <span class="ot">&lt;-</span> results[results<span class="sc">$</span>drift_symptom_severity <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">5</span>, ]</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of outliers</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>removed_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(results) <span class="sc">-</span> <span class="fu">nrow</span>(filtered_results)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows removed:"</span>, removed_rows, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows removed: 18 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(filtered_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      iter       drift_symptom_severity drift_symptom_severity_lower
 Min.   :  1.0   Min.   :-4.2111        Min.   :-52.308             
 1st Qu.:128.2   1st Qu.:-0.6701        1st Qu.: -1.523             
 Median :253.5   Median :-0.5233        Median : -1.233             
 Mean   :251.7   Mean   :-0.5850        Mean   : -1.742             
 3rd Qu.:375.8   3rd Qu.:-0.3829        3rd Qu.: -1.058             
 Max.   :500.0   Max.   : 0.0000        Max.   :  0.000             
 drift_symptom_severity_upper drift_symptom_severity_significance
 Min.   :-0.894451            Min.   :1                          
 1st Qu.:-0.274740            1st Qu.:1                          
 Median :-0.152397            Median :1                          
 Mean   :-0.191179            Mean   :1                          
 3rd Qu.:-0.056890            3rd Qu.:1                          
 Max.   :-0.000001            Max.   :1                          
 drift_symptom_severity_avoidance drift_symptom_severity_avoidance_lower
 Min.   :-1.2762                  Min.   :-3.82204                      
 1st Qu.: 0.0098                  1st Qu.:-0.47550                      
 Median : 0.2100                  Median :-0.27844                      
 Mean   : 0.2158                  Mean   :-0.29701                      
 3rd Qu.: 0.4213                  3rd Qu.:-0.08455                      
 Max.   : 1.0791                  Max.   : 0.88861                      
 drift_symptom_severity_avoidance_upper
 Min.   :-0.7453                       
 1st Qu.: 0.4695                       
 Median : 0.6997                       
 Mean   : 0.7285                       
 3rd Qu.: 0.9399                       
 Max.   : 5.7929                       
 drift_symptom_severity_avoidance_significance drift_avoidance_symptom_severity
 Min.   :0.0000                                Min.   :-0.6479                 
 1st Qu.:0.0000                                1st Qu.: 0.1030                 
 Median :0.0000                                Median : 0.2497                 
 Mean   :0.2116                                Mean   : 0.2611                 
 3rd Qu.:0.0000                                3rd Qu.: 0.4047                 
 Max.   :1.0000                                Max.   : 1.1854                 
 drift_avoidance_symptom_severity_lower drift_avoidance_symptom_severity_upper
 Min.   :-4.81566                       Min.   :-0.2309                       
 1st Qu.:-0.28961                       1st Qu.: 0.4609                       
 Median :-0.12167                       Median : 0.6360                       
 Mean   :-0.14934                       Mean   : 0.6712                       
 3rd Qu.: 0.03818                       3rd Qu.: 0.8133                       
 Max.   : 0.87069                       Max.   : 5.1402                       
 drift_avoidance_symptom_severity_significance drift_avoidance    
 Min.   :0.0000                                Min.   :-697.3321  
 1st Qu.:0.0000                                1st Qu.:  -0.7586  
 Median :0.0000                                Median :  -0.5710  
 Mean   :0.3174                                Mean   :  -2.6566  
 3rd Qu.:1.0000                                3rd Qu.:  -0.4468  
 Max.   :1.0000                                Max.   :   0.0000  
 drift_avoidance_lower drift_avoidance_upper drift_avoidance_significance
 Min.   :-3602.811     Min.   :-1.087172     Min.   :1                   
 1st Qu.:   -1.510     1st Qu.:-0.363425     1st Qu.:1                   
 Median :   -1.235     Median :-0.217131     Median :1                   
 Mean   :  -12.143     Mean   :-0.256579     Mean   :1                   
 3rd Qu.:   -1.062     3rd Qu.:-0.114464     3rd Qu.:1                   
 Max.   :    0.000     Max.   :-0.000001     Max.   :1                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_results, <span class="fu">aes</span>(<span class="at">x =</span> drift_symptom_severity)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color      =</span> <span class="st">"red"</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype   =</span> <span class="st">"dashed"</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">size       =</span> <span class="dv">1</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of estimates"</span>,</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Hufigkeit"</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Wahrer Wert ="</span>, drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>]),</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simulations_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_results, <span class="fu">aes</span>(<span class="at">x =</span> drift_symptom_severity)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color      =</span> <span class="st">"red"</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype   =</span> <span class="st">"dashed"</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size       =</span> <span class="dv">1</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of estimates"</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Hufigkeit"</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Wahrer Wert ="</span>, drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>]),</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simulations_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot drift_symptom_severity</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove outliers</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>filtered_results_5000 <span class="ot">&lt;-</span> results_t_5000[results_t_5000<span class="sc">$</span>drift_symptom_severity <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">5</span>, ]</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of outliers</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>removed_rows <span class="ot">&lt;-</span> <span class="fu">nrow</span>(results_t_5000) <span class="sc">-</span> <span class="fu">nrow</span>(filtered_results_5000)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Number of rows removed:"</span>, removed_rows, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows removed: 2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(filtered_results_5000)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      iter       drift_symptom_severity drift_symptom_severity_lower
 Min.   :  1.0   Min.   :-1.6826        Min.   :-9.2949             
 1st Qu.:127.2   1st Qu.:-0.2819        1st Qu.:-0.3661             
 Median :251.5   Median :-0.2556        Median :-0.3350             
 Mean   :251.2   Mean   :-0.2596        Mean   :-0.3637             
 3rd Qu.:375.8   3rd Qu.:-0.2278        3rd Qu.:-0.3028             
 Max.   :500.0   Max.   :-0.1272        Max.   :-0.2070             
 drift_symptom_severity_upper drift_symptom_severity_significance
 Min.   :-0.326162            Min.   :1                          
 1st Qu.:-0.217257            1st Qu.:1                          
 Median :-0.190247            Median :1                          
 Mean   :-0.190277            Mean   :1                          
 3rd Qu.:-0.162189            3rd Qu.:1                          
 Max.   :-0.000749            Max.   :1                          
 drift_symptom_severity_avoidance drift_symptom_severity_avoidance_lower
 Min.   :0.0315                   Min.   :-2.75606                      
 1st Qu.:0.1700                   1st Qu.: 0.07973                      
 Median :0.2024                   Median : 0.11549                      
 Mean   :0.2015                   Mean   : 0.10231                      
 3rd Qu.:0.2316                   3rd Qu.: 0.14749                      
 Max.   :0.3938                   Max.   : 0.27529                      
 drift_symptom_severity_avoidance_upper
 Min.   :0.1237                        
 1st Qu.:0.2514                        
 Median :0.2858                        
 Mean   :0.3009                        
 3rd Qu.:0.3210                        
 Max.   :3.5739                        
 drift_symptom_severity_avoidance_significance drift_avoidance_symptom_severity
 Min.   :0.0000                                Min.   :0.1679                  
 1st Qu.:1.0000                                1st Qu.:0.2431                  
 Median :1.0000                                Median :0.2676                  
 Mean   :0.9719                                Mean   :0.2683                  
 3rd Qu.:1.0000                                3rd Qu.:0.2919                  
 Max.   :1.0000                                Max.   :0.3770                  
 drift_avoidance_symptom_severity_lower drift_avoidance_symptom_severity_upper
 Min.   :-2.7554                        Min.   :0.2235                        
 1st Qu.: 0.1766                        1st Qu.:0.3075                        
 Median : 0.2014                        Median :0.3346                        
 Mean   : 0.1868                        Mean   :0.3495                        
 3rd Qu.: 0.2263                        3rd Qu.:0.3642                        
 Max.   : 0.3085                        Max.   :3.2784                        
 drift_avoidance_symptom_severity_significance drift_avoidance  
 Min.   :0.000                                 Min.   :-1.5098  
 1st Qu.:1.000                                 1st Qu.:-0.4147  
 Median :1.000                                 Median :-0.3849  
 Mean   :0.988                                 Mean   :-0.3914  
 3rd Qu.:1.000                                 3rd Qu.:-0.3600  
 Max.   :1.000                                 Max.   :-0.2574  
 drift_avoidance_lower drift_avoidance_upper drift_avoidance_significance
 Min.   :-8.7978       Min.   :-0.4514249    Min.   :1                   
 1st Qu.:-0.4994       1st Qu.:-0.3494334    1st Qu.:1                   
 Median :-0.4683       Median :-0.3147014    Median :1                   
 Mean   :-0.4972       Mean   :-0.3161157    Mean   :1                   
 3rd Qu.:-0.4337       3rd Qu.:-0.2900114    3rd Qu.:1                   
 Max.   :-0.3186       Max.   :-0.0006848    Max.   :1                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_results_5000, <span class="fu">aes</span>(<span class="at">x =</span> drift_symptom_severity)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color      =</span> <span class="st">"red"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype   =</span> <span class="st">"dashed"</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size       =</span> <span class="dv">1</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of estimates"</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Hufigkeit"</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Wahrer Wert ="</span>, drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>]),</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simulations_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_results_5000, <span class="fu">aes</span>(<span class="at">x =</span> drift_symptom_severity)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color      =</span> <span class="st">"red"</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype   =</span> <span class="st">"dashed"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">size       =</span> <span class="dv">1</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of estimates"</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Estimate"</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Hufigkeit"</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>],</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Wahrer Wert ="</span>, drift_matrix_true[<span class="dv">1</span>,<span class="dv">1</span>]),</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>,</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="simulations_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="model-with-3-latent-processes" class="level2">
<h2 class="anchored" data-anchor-id="model-with-3-latent-processes">Model with 3 latent processes</h2>
<section id="model-specification-1" class="level3">
<h3 class="anchored" data-anchor-id="model-specification-1">Model specification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # compute drift matrix from discrete time effects with a time interval of 1</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># drift_matrix_2 &lt;- logm(matrix(c(0.8, 0.1, 0.2, 0.25, 0.7, 0.15, 0.3, 0.25, 0.85), nrow = 3)) / delta_t</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # model to simulate data</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generating_model_2 &lt;-ctModel(Tpoints = 200, n.latent = 3, n.TDpred = 0, n.TIpred = 0, n.manifest = 3,</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                              MANIFESTVAR = diag(.1, 3),</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                              LAMBDA = diag(1, 3),</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                              MANIFESTMEANS = matrix(0, ncol = 1, nrow = 2),</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                              DRIFT = drift_matrix_2,</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                              #TRAITVAR = matrix(c(.5, .2, .3, 0, .8, .1, 0, 0, .7), nrow=3),</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                              DIFFUSION = matrix(c(0.5, 0.2, 0.3, 0, 0.4, 0.2, 0, 0, 0.5), nrow = 3),</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                              #CINT = matrix(c(1, 0, 1), ncol = 1, nrow=3),</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                              T0MEANS = matrix(1, ncol = 1, nrow = 3),</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                              T0VAR = diag(0.1, 3),</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                              #TIPREDMEANS = diag(0, 1),</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                              #TIPREDVAR = diag(1, 1),</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                              #TIPREDEFFECT = matrix(c(.1, .15, .1), ncol = 1, nrow=3)</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                              )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data_2 &lt;- ctGenerate(generating_model_2, n.subjects = 1, burnin = 100, dtmean = .3, logdtsd = .1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-up" class="level3">
<h3 class="anchored" data-anchor-id="set-up">Set up</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model_2 &lt;- ctModel(type = "stanct",</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                    n.latent = 3, latentNames=c('symptom_severity','avoidance', 'self_compassion'),</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                    n.manifest = 3, manifestNames=c('Y1','Y2', 'Y3'),</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                    #CINT = matrix(c('cint1', 'cint2', 'cint3'), nrow = 3, ncol = 1), #free cont intercept</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                    #MANIFESTMEANS = matrix(c(0,0,0), nrow = 3), # fix manifest means to 0</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                    LAMBDA=diag(3))</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #ctModelLatex(model_1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(model_2$pars)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-fitting-1" class="level3">
<h3 class="anchored" data-anchor-id="model-fitting-1">Model fitting</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_2 &lt;- ctStanFit(datalong = data_2, ctstanmodel = model_2, priors = FALSE, optimize = TRUE) </span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # priors: True -&gt; HMC, false -&gt; max likelihood</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>